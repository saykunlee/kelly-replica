{
  "openapi": "3.0.3",
  "info": {
    "title": "Kelly API",
    "description": "RESTful API for Kelly Project - Azure API Design Best Practices 기반",
    "version": "1.0.0",
    "contact": {
      "name": "Kelly Development Team",
      "email": "support@example.com"
    },
    "license": {
      "name": "MIT",
      "url": "https://opensource.org/licenses/MIT"
    }
  },
  "servers": [
    {
      "url": "http://localhost:3005/api/v1",
      "description": "Local Development Server"
    },
    {
      "url": "http://staging.example.com/api/v1",
      "description": "Staging Server"
    },
    {
      "url": "https://api.example.com/api/v1",
      "description": "Production Server"
    }
  ],
  "tags": [
    {
      "name": "Members",
      "description": "회원 관리 API"
    },
    {
      "name": "Jobs",
      "description": "비동기 작업 API"
    }
  ],
  "paths": {
    "/members": {
      "get": {
        "tags": ["Members"],
        "summary": "회원 목록 조회",
        "description": "회원 목록을 페이지네이션, 필터링, 정렬하여 조회합니다.",
        "operationId": "getMembers",
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "description": "페이지 번호 (1부터 시작)",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "페이지당 항목 수",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 20
            }
          },
          {
            "name": "sort",
            "in": "query",
            "description": "정렬 필드",
            "required": false,
            "schema": {
              "type": "string",
              "default": "mem_id",
              "enum": ["mem_id", "mem_username", "mem_email", "mem_created_at"]
            }
          },
          {
            "name": "order",
            "in": "query",
            "description": "정렬 순서",
            "required": false,
            "schema": {
              "type": "string",
              "default": "DESC",
              "enum": ["ASC", "DESC"]
            }
          },
          {
            "name": "mem_email",
            "in": "query",
            "description": "이메일로 필터링",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "mem_level",
            "in": "query",
            "description": "회원 레벨로 필터링",
            "required": false,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "성공",
            "headers": {
              "X-RateLimit-Limit": {
                "schema": {
                  "type": "integer"
                },
                "description": "시간당 최대 요청 수"
              },
              "X-RateLimit-Remaining": {
                "schema": {
                  "type": "integer"
                },
                "description": "남은 요청 수"
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MemberListResponse"
                }
              }
            }
          },
          "429": {
            "description": "Rate Limit 초과",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Members"],
        "summary": "회원 생성",
        "description": "새로운 회원을 생성합니다. 비밀번호는 자동으로 해싱됩니다.",
        "operationId": "createMember",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MemberCreate"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "생성 성공",
            "headers": {
              "Location": {
                "schema": {
                  "type": "string"
                },
                "description": "생성된 리소스 URL"
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MemberResponse"
                }
              }
            }
          },
          "422": {
            "description": "유효성 검증 실패",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ValidationErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/members/{id}": {
      "get": {
        "tags": ["Members"],
        "summary": "회원 상세 조회",
        "description": "특정 회원의 상세 정보를 조회합니다. ETag 캐싱을 지원합니다.",
        "operationId": "getMember",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "회원 ID",
            "required": true,
            "schema": {
              "type": "integer"
            }
          },
          {
            "name": "If-None-Match",
            "in": "header",
            "description": "ETag 값 (조건부 요청)",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "성공",
            "headers": {
              "ETag": {
                "schema": {
                  "type": "string"
                },
                "description": "리소스 고유 해시"
              },
              "Cache-Control": {
                "schema": {
                  "type": "string"
                },
                "description": "캐시 제어 헤더"
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MemberResponse"
                }
              }
            }
          },
          "304": {
            "description": "Not Modified (캐시 사용)"
          },
          "404": {
            "description": "리소스를 찾을 수 없음",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["Members"],
        "summary": "회원 전체 수정",
        "description": "회원 정보를 전체적으로 수정합니다. 모든 필수 필드를 포함해야 합니다.",
        "operationId": "updateMember",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "회원 ID",
            "required": true,
            "schema": {
              "type": "integer"
            }
          },
          {
            "name": "If-Match",
            "in": "header",
            "description": "ETag 값 (낙관적 동시성 제어)",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MemberUpdate"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "수정 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MemberResponse"
                }
              }
            }
          },
          "404": {
            "description": "리소스를 찾을 수 없음"
          },
          "412": {
            "description": "Precondition Failed (ETag 불일치)",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      },
      "patch": {
        "tags": ["Members"],
        "summary": "회원 부분 수정",
        "description": "회원 정보를 부분적으로 수정합니다. 변경하려는 필드만 포함하면 됩니다.",
        "operationId": "patchMember",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "회원 ID",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MemberPatch"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "수정 성공",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MemberResponse"
                }
              }
            }
          },
          "404": {
            "description": "리소스를 찾을 수 없음"
          }
        }
      },
      "delete": {
        "tags": ["Members"],
        "summary": "회원 삭제",
        "description": "회원을 삭제합니다.",
        "operationId": "deleteMember",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "회원 ID",
            "required": true,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "삭제 성공 (본문 없음)"
          },
          "404": {
            "description": "리소스를 찾을 수 없음"
          }
        }
      }
    },
    "/members/test": {
      "get": {
        "tags": ["Members"],
        "summary": "테스트 엔드포인트",
        "description": "API 동작 확인용 테스트 엔드포인트입니다.",
        "operationId": "testMembers",
        "responses": {
          "200": {
            "description": "성공",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object"
                    },
                    "links": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/Link"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/jobs/{jobId}": {
      "get": {
        "tags": ["Jobs"],
        "summary": "작업 상태 조회",
        "description": "비동기 작업의 현재 상태를 조회합니다.",
        "operationId": "getJobStatus",
        "parameters": [
          {
            "name": "jobId",
            "in": "path",
            "description": "작업 ID",
            "required": true,
            "schema": {
              "type": "string",
              "example": "job_abc123"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "작업 진행 중 또는 대기 중",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/JobStatusResponse"
                }
              }
            }
          },
          "303": {
            "description": "작업 완료 (리다이렉트)",
            "headers": {
              "Location": {
                "schema": {
                  "type": "string"
                },
                "description": "결과 리소스 URL"
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "integer",
                      "example": 303
                    },
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "작업이 완료되었습니다"
                    },
                    "location": {
                      "type": "string",
                      "example": "http://localhost:3005/api/v1/members/123"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "작업을 찾을 수 없음"
          }
        }
      },
      "delete": {
        "tags": ["Jobs"],
        "summary": "작업 취소",
        "description": "진행 중인 작업을 취소합니다.",
        "operationId": "cancelJob",
        "parameters": [
          {
            "name": "jobId",
            "in": "path",
            "description": "작업 ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "취소 성공",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "integer",
                      "example": 200
                    },
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "message": {
                          "type": "string",
                          "example": "작업이 취소되었습니다"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "취소 실패"
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "Member": {
        "type": "object",
        "properties": {
          "mem_id": {
            "type": "integer",
            "description": "회원 ID",
            "example": 1
          },
          "mem_userid": {
            "type": "string",
            "description": "사용자 ID",
            "example": "user001"
          },
          "mem_email": {
            "type": "string",
            "format": "email",
            "description": "이메일",
            "example": "user@example.com"
          },
          "mem_username": {
            "type": "string",
            "description": "이름",
            "example": "홍길동"
          },
          "mem_nickname": {
            "type": "string",
            "description": "닉네임",
            "example": "길동이"
          },
          "mem_phone": {
            "type": "string",
            "description": "전화번호",
            "example": "010-1234-5678"
          },
          "mem_level": {
            "type": "integer",
            "description": "회원 레벨",
            "example": 1
          },
          "mem_created_at": {
            "type": "string",
            "format": "date-time",
            "description": "생성일시",
            "example": "2025-01-01T10:00:00Z"
          },
          "mem_updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "수정일시",
            "example": "2025-01-15T14:30:00Z"
          },
          "links": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Link"
            }
          }
        }
      },
      "MemberCreate": {
        "type": "object",
        "required": [
          "mem_userid",
          "mem_password",
          "mem_email",
          "mem_username"
        ],
        "properties": {
          "mem_userid": {
            "type": "string",
            "minLength": 4,
            "maxLength": 50,
            "description": "사용자 ID (4-50자, 고유값)",
            "example": "newuser001"
          },
          "mem_password": {
            "type": "string",
            "minLength": 8,
            "format": "password",
            "description": "비밀번호 (최소 8자)",
            "example": "securePassword123!"
          },
          "mem_email": {
            "type": "string",
            "format": "email",
            "description": "이메일 (고유값)",
            "example": "newuser@example.com"
          },
          "mem_username": {
            "type": "string",
            "maxLength": 100,
            "description": "이름 (최대 100자)",
            "example": "신규 사용자"
          },
          "mem_nickname": {
            "type": "string",
            "maxLength": 50,
            "description": "닉네임 (선택)",
            "example": "뉴비"
          },
          "mem_phone": {
            "type": "string",
            "maxLength": 20,
            "description": "전화번호 (선택)",
            "example": "010-9999-8888"
          },
          "mem_level": {
            "type": "integer",
            "description": "회원 레벨 (선택)",
            "example": 1
          }
        }
      },
      "MemberUpdate": {
        "type": "object",
        "required": [
          "mem_email",
          "mem_username"
        ],
        "properties": {
          "mem_email": {
            "type": "string",
            "format": "email",
            "description": "이메일",
            "example": "updated@example.com"
          },
          "mem_username": {
            "type": "string",
            "maxLength": 100,
            "description": "이름",
            "example": "수정된 이름"
          },
          "mem_nickname": {
            "type": "string",
            "maxLength": 50,
            "description": "닉네임 (선택)",
            "example": "수정닉네임"
          },
          "mem_phone": {
            "type": "string",
            "maxLength": 20,
            "description": "전화번호 (선택)",
            "example": "010-5555-6666"
          }
        }
      },
      "MemberPatch": {
        "type": "object",
        "properties": {
          "mem_email": {
            "type": "string",
            "format": "email",
            "description": "이메일 (선택)"
          },
          "mem_username": {
            "type": "string",
            "maxLength": 100,
            "description": "이름 (선택)"
          },
          "mem_nickname": {
            "type": "string",
            "maxLength": 50,
            "description": "닉네임 (선택)"
          },
          "mem_phone": {
            "type": "string",
            "maxLength": 20,
            "description": "전화번호 (선택)"
          }
        }
      },
      "MemberResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "integer",
            "example": 200
          },
          "success": {
            "type": "boolean",
            "example": true
          },
          "data": {
            "$ref": "#/components/schemas/Member"
          },
          "message": {
            "type": "string",
            "description": "응답 메시지 (선택, 201 Created 시 포함)",
            "example": "리소스가 생성되었습니다"
          }
        },
        "required": ["status", "success", "data"]
      },
      "MemberListResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "integer",
            "example": 200
          },
          "success": {
            "type": "boolean",
            "example": true
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Member"
            }
          },
          "meta": {
            "$ref": "#/components/schemas/PaginationMeta"
          },
          "links": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Link"
            }
          }
        }
      },
      "PaginationMeta": {
        "type": "object",
        "properties": {
          "total": {
            "type": "integer",
            "description": "전체 항목 수",
            "example": 100
          },
          "page": {
            "type": "integer",
            "description": "현재 페이지",
            "example": 1
          },
          "limit": {
            "type": "integer",
            "description": "페이지당 항목 수",
            "example": 20
          },
          "totalPages": {
            "type": "integer",
            "description": "전체 페이지 수",
            "example": 5
          }
        }
      },
      "Link": {
        "type": "object",
        "properties": {
          "rel": {
            "type": "string",
            "description": "링크 관계",
            "example": "self",
            "enum": [
              "self",
              "next",
              "prev",
              "first",
              "last",
              "collection",
              "update",
              "patch",
              "delete"
            ]
          },
          "href": {
            "type": "string",
            "description": "링크 URL",
            "example": "http://localhost:3005/api/v1/members/1"
          },
          "method": {
            "type": "string",
            "description": "HTTP 메서드",
            "example": "GET",
            "enum": ["GET", "POST", "PUT", "PATCH", "DELETE"]
          }
        },
        "required": ["rel", "href", "method"]
      },
      "JobStatusResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "integer",
            "example": 200
          },
          "success": {
            "type": "boolean",
            "example": true
          },
          "data": {
            "type": "object",
            "properties": {
              "jobId": {
                "type": "string",
                "example": "job_abc123"
              },
              "status": {
                "type": "string",
                "enum": ["pending", "processing", "completed", "failed", "cancelled"],
                "example": "processing"
              },
              "progress": {
                "type": "integer",
                "minimum": 0,
                "maximum": 100,
                "example": 75
              },
              "message": {
                "type": "string",
                "example": "작업 진행 중... (75%)"
              },
              "createdAt": {
                "type": "string",
                "format": "date-time"
              },
              "startedAt": {
                "type": "string",
                "format": "date-time"
              },
              "completedAt": {
                "type": "string",
                "format": "date-time"
              }
            }
          },
          "links": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Link"
            }
          }
        }
      },
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "integer",
            "example": 400
          },
          "success": {
            "type": "boolean",
            "example": false
          },
          "message": {
            "type": "string",
            "example": "에러 메시지"
          },
          "errorCode": {
            "type": "string",
            "example": "ERROR_CODE"
          }
        }
      },
      "ValidationErrorResponse": {
        "type": "object",
        "properties": {
          "status": {
            "type": "integer",
            "example": 422
          },
          "success": {
            "type": "boolean",
            "example": false
          },
          "message": {
            "type": "string",
            "example": "유효성 검증 실패"
          },
          "errorCode": {
            "type": "string",
            "example": "VALIDATION_ERROR"
          },
          "errors": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "field": {
                  "type": "string",
                  "example": "mem_email"
                },
                "message": {
                  "type": "string",
                  "example": "올바른 이메일 형식이 아닙니다"
                }
              }
            }
          }
        }
      }
    },
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "description": "JWT Bearer Token (향후 지원 예정)"
      },
      "ApiKeyAuth": {
        "type": "apiKey",
        "in": "header",
        "name": "X-API-Key",
        "description": "API Key (향후 지원 예정)"
      }
    }
  }
}

